"use strict";define("web-tuner/app",["exports","ember","web-tuner/resolver","ember-load-initializers","web-tuner/config/environment"],function(e,t,n,l,a){var r=void 0;t.default.MODEL_FACTORY_INJECTIONS=!0,r=t.default.Application.extend({modulePrefix:a.default.modulePrefix,podModulePrefix:a.default.podModulePrefix,Resolver:n.default}),(0,l.default)(r,a.default.modulePrefix),e.default=r}),define("web-tuner/controllers/tuner",["exports","ember"],function(e,t){function n(e,t,n){e.getFloatFrequencyData(u);u.forEach(function(t,n){return u[n]=1*(t-e.minDecibels)});for(var a=[],r=[],o=-1/0,i=-1/0,c=0;c<s/2;++c){var m=u[c],d=t*c/s;if(d>2e4)break;m>o&&(i=d,o=m),a.push(d),r.push(m)}return n&&l(a,r),{frequency:i,power:o}}function l(e,t){document.getElementById("frequencyPlot")||o();var n={title:"Frequency Analysis",displayModeBar:!1,yaxis:{title:"Power (dB)",fixedrange:!0},xaxis:{title:"Frequency (Hz)",fixedrange:!0}},l=[{x:e,y:t,mode:"lines"}];Plotly.newPlot(document.getElementById("frequencyPlot"),l,n)}function a(e,t){return e.map(function(e){return e[t]}).reduce(function(e,t){return e+t},0)/c}function r(e){for(var t=0;t<9;++t)for(var n=12*t,l=0;l<12;++l){var a=m[n+l];m.push(2*a)}m.forEach(function(e,t){return m[t]=e.toPrecision(9)})}function o(){Plotly.d3.select("#frequencyPlot-container").append("div").attr("id","frequencyPlot").style({width:400,height:300})}var i=t.default.Logger,s=16384,u=(new Float32Array(s),new Float32Array(s)),c=5,m=[8.1757989156,8.661957218,9.1770239974,9.7227182413,10.3008611535,10.9133822323,11.5623257097,12.2498573744,12.9782717994,13.75,14.5676175474,15.4338531643],d=["C","D♭","D","E♭","E","F","F♯","G","G♯","A","Bb","B"];e.default=t.default.Controller.extend({canRecord:!0,hasMedia:!0,showDetailedAnalysis:!1,lastNPeaks:[],fftSize:s,sampleRate:null,lowerDBThreshold:20,frequencyAverage:t.default.computed("lastNPeaks",function(){return a(this.get("lastNPeaks"),"frequency").toPrecision(8)}),powerAverage:t.default.computed("lastNPeaks",function(){return a(this.get("lastNPeaks"),"power").toPrecision(8)}),currentNote:t.default.computed("frequencyAverage","powerAverage",function(){if(this.get("powerAverage")<20)return{name:"∅"};var e=this.get("frequencyAverage"),t=m.reduce(function(t,n,l){var a=Math.abs(e-n);return a<t.dist?{dist:a,idx:l,ideal:n}:t},{dist:1/0,idx:1/0,ideal:1/0}),n=t.dist,l=t.idx,a=t.ideal;return n===1/0||null===n||void 0===n?(i.error("Found a bad distnace to nearest note: "+n+" with idx: "+l),{name:"∅"}):{name:d[l%12],cents:1200*Math.log2(e/Math.round(a))}}),mutedNote:t.default.computed("currentNote",function(){return void 0===this.get("currentNote").cents?"muted-note":""}),formattedCents:t.default.computed("currentNote",function(){var e=this.get("currentNote"),t=document.getElementById("centBar");if(!t||!t.getContext("2d"))return i.error("Something bad happened. Could not find cent bar!"),0;var n=t.getContext("2d");if(n.clearRect(0,0,30,225),void 0===e.cents)return 0;var l=e.cents.toPrecision(2),a=-l/100*112.5,r=l>0?"red":"blue",o=this.get("frequencyAverage"),s=5;return o<98?s=33:o<117?s=25:o<139?s=16:o<247&&(s=11),Math.abs(l)<=s&&(r="green",a=5,l=0),n.fillStyle=r,n.fillRect(0,112.5,30,a),l}),init:function(){t.default.run.schedule("afterRender",this,function(){var e=this;this.get("showDetailedAnalysis")&&o(),navigator.getUserMedia||(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),navigator.getUserMedia?navigator.getUserMedia({audio:!0},function(t){i.debug("Found stream"),e.initMicrophone(t)},function(t){i.debug("Error caught while recording: "+JSON.stringify(t)),e.set("canRecord",!1)}):(e.set("hasMedia",!1),i.debug("Something bad happened trying to find media"))}),r((new AudioContext).sampleRate)},initMicrophone:function(e){var t=this;i.debug("Initializing microphone...");var n=new AudioContext,l=n.createMediaStreamSource(e);i.debug("-- Created audio stream source from microphone"),i.debug("-- Created noise filters");var a=n.createBiquadFilter();a.frequency.value=141,a.Q.value=.00705,a.type="bandpass";var r=n.createAnalyser();r.fftSize=s,i.debug("-- Created analyzer for FFT");var o=n.createScriptProcessor(s,1,1);o.onaudioprocess=function(e){t.processAudio(r,n.sampleRate)},i.debug("-- Created audio processor"),i.debug("-- Connecting audio processing pipeline"),l.connect(a),a.connect(r),r.connect(o),o.connect(n.destination),this.set("sampleRate",n.sampleRate),i.debug("Done.")},processAudio:function(e,t){var l=n(e,t,this.get("showDetailedAnalysis")),a=this.get("lastNPeaks");a.length>=c?this.set("lastNPeaks",a.slice(1).concat(l)):this.set("lastNPeaks",a.concat(l))},actions:{enableDetailedAnalysis:function(e){this.set("showDetailedAnalysis",e)}}})}),define("web-tuner/helpers/app-version",["exports","ember","web-tuner/config/environment","ember-cli-app-version/utils/regexp"],function(e,t,n,l){function a(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.hideSha?r.match(l.versionRegExp)[0]:t.hideVersion?r.match(l.shaRegExp)[0]:r}e.appVersion=a;var r=n.default.APP.version;e.default=t.default.Helper.helper(a)}),define("web-tuner/helpers/pluralize",["exports","ember-inflector/lib/helpers/pluralize"],function(e,t){e.default=t.default}),define("web-tuner/helpers/singularize",["exports","ember-inflector/lib/helpers/singularize"],function(e,t){e.default=t.default}),define("web-tuner/initializers/app-version",["exports","ember-cli-app-version/initializer-factory","web-tuner/config/environment"],function(e,t,n){var l=n.default.APP,a=l.name,r=l.version;e.default={name:"App Version",initialize:(0,t.default)(a,r)}}),define("web-tuner/initializers/container-debug-adapter",["exports","ember-resolver/container-debug-adapter"],function(e,t){e.default={name:"container-debug-adapter",initialize:function(){var e=arguments[1]||arguments[0];e.register("container-debug-adapter:main",t.default),e.inject("container-debug-adapter:main","namespace","application:main")}}}),define("web-tuner/initializers/data-adapter",["exports","ember"],function(e,t){e.default={name:"data-adapter",before:"store",initialize:function(){}}}),define("web-tuner/initializers/ember-data",["exports","ember-data/setup-container","ember-data/-private/core"],function(e,t,n){e.default={name:"ember-data",initialize:t.default}}),define("web-tuner/initializers/export-application-global",["exports","ember","web-tuner/config/environment"],function(e,t,n){function l(){var e=arguments[1]||arguments[0];if(!1!==n.default.exportApplicationGlobal){var l;if("undefined"!=typeof window)l=window;else if("undefined"!=typeof global)l=global;else{if("undefined"==typeof self)return;l=self}var a,r=n.default.exportApplicationGlobal;a="string"==typeof r?r:t.default.String.classify(n.default.modulePrefix),l[a]||(l[a]=e,e.reopen({willDestroy:function(){this._super.apply(this,arguments),delete l[a]}}))}}e.initialize=l,e.default={name:"export-application-global",initialize:l}}),define("web-tuner/initializers/injectStore",["exports","ember"],function(e,t){e.default={name:"injectStore",before:"store",initialize:function(){}}}),define("web-tuner/initializers/store",["exports","ember"],function(e,t){e.default={name:"store",after:"ember-data",initialize:function(){}}}),define("web-tuner/initializers/transforms",["exports","ember"],function(e,t){e.default={name:"transforms",before:"store",initialize:function(){}}}),define("web-tuner/instance-initializers/ember-data",["exports","ember-data/-private/instance-initializers/initialize-store-service"],function(e,t){e.default={name:"ember-data",initialize:t.default}}),define("web-tuner/resolver",["exports","ember-resolver"],function(e,t){e.default=t.default}),define("web-tuner/router",["exports","ember","web-tuner/config/environment"],function(e,t,n){var l=t.default.Router.extend({location:n.default.locationType,rootURL:n.default.rootURL});l.map(function(){this.route("tuner"),this.route("about",{path:"/about.html"}),this.route("not-found",{path:"/*path"})}),e.default=l}),define("web-tuner/routes/index",["exports","ember"],function(e,t){e.default=t.default.Route.extend({beforeModel:function(){this.transitionTo("tuner")}})}),define("web-tuner/routes/tuner",["exports","ember"],function(e,t){e.default=t.default.Route.extend({})}),define("web-tuner/services/ajax",["exports","ember-ajax/services/ajax"],function(e,t){Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.default}})}),define("web-tuner/templates/about",["exports"],function(e){e.default=Ember.HTMLBars.template({id:"Y58RGr8s",block:'{"statements":[["open-element","div",[]],["static-attr","class","row"],["flush-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","col s12 center"],["flush-element"],["text","\\n        "],["open-element","h2",[]],["flush-element"],["text","About"],["close-element"],["text","\\n    "],["close-element"],["text","\\n"],["close-element"],["text","\\n"],["open-element","div",[]],["static-attr","class","row"],["flush-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","col s3"],["flush-element"],["close-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","col s6"],["flush-element"],["text","\\n        "],["open-element","p",[]],["flush-element"],["text","The browser-based chromatic web tuner was created by Dennis J. McWherter, Jr. If you have any questions, comments, or concerns, please e-mail him at "],["open-element","em",[]],["flush-element"],["text","dennis [at] deathbytape [dot] com"],["close-element"],["text",".\\n           The intent of this tool is two-fold: to provide a more in-depth look into the measurement parameters from a web-based tuner as well as introduce a functional browser-based chromatic tuner."],["close-element"],["text","\\n        "],["open-element","p",[]],["flush-element"],["text","While the tuner is seemingly performing well enough for a musician with a trained ear, there are currently some notable limitations. Most notably is that the built-in FFT functionality doesn\'t\\n           provide us with a clear picture for low frequencies. As a result, we compensate an error of up to "],["open-element","strong",[]],["flush-element"],["text","±33.0 cents"],["close-element"],["text"," at our lowest frequencies (i.e. anything less than 98.0Hz).\\n           Moreover, this error improves with higher frequencies. However, again due to binning limitations of the FFT, we have another inherent tolerance of at least "],["open-element","strong",[]],["flush-element"],["text","±5.0 cents"],["close-element"],["text","\\n           for all other frequencies. This is to say, at the lowest frequencies the tuner may read \\"in-tune\\" for a note ±33.0 out of tune, and minimally is only accurate for ±5.0 cents for\\n           any other note."],["close-element"],["text","\\n        "],["open-element","p",[]],["flush-element"],["text","Though these issues exist, I do have plans to fix them in the future! Namely, investigating other DFFT algorithms (i.e. Chirp or similar) may help eliminate the problems that arise while using a\\n           general DFFT approach."],["close-element"],["text"," \\n    "],["close-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","col s3"],["flush-element"],["close-element"],["text","\\n"],["close-element"]],"locals":[],"named":[],"yields":[],"blocks":[],"hasPartials":false}',meta:{moduleName:"web-tuner/templates/about.hbs"}})}),define("web-tuner/templates/application",["exports"],function(e){e.default=Ember.HTMLBars.template({id:"qZ9VyBQZ",block:'{"statements":[["append",["unknown",["outlet"]],false]],"locals":[],"named":[],"yields":[],"blocks":[],"hasPartials":false}',meta:{moduleName:"web-tuner/templates/application.hbs"}})}),define("web-tuner/templates/not-found",["exports"],function(e){e.default=Ember.HTMLBars.template({id:"6jxf2akM",block:'{"statements":[["open-element","div",[]],["static-attr","class","row vertical-align"],["flush-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","col s12 center"],["flush-element"],["text","\\n        "],["open-element","h3",[]],["flush-element"],["text","The page you\'re looking for is not here!"],["close-element"],["text","\\n        "],["open-element","p",[]],["flush-element"],["text","Try going back to the "],["block",["link-to"],["tuner"],null,0],["close-element"],["text","\\n    "],["close-element"],["text","\\n"],["close-element"]],"locals":[],"named":[],"yields":[],"blocks":[{"statements":[["text","tuner"]],"locals":[]}],"hasPartials":false}',meta:{moduleName:"web-tuner/templates/not-found.hbs"}})}),define("web-tuner/templates/tuner",["exports"],function(e){e.default=Ember.HTMLBars.template({id:"GEqTwQ7n",block:'{"statements":[["open-element","div",[]],["static-attr","id","tuner-container"],["flush-element"],["text","\\n    "],["comment"," Tuner "],["text","\\n    "],["open-element","div",[]],["static-attr","class","row col s12 center"],["flush-element"],["text","\\n        "],["open-element","p",[]],["flush-element"],["text","Play a note!"],["close-element"],["text","\\n    "],["close-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","row"],["flush-element"],["text","\\n        "],["open-element","div",[]],["static-attr","class","col s6 right-align note-container"],["flush-element"],["text","\\n            "],["open-element","p",[]],["dynamic-attr","class",["concat",["current-note ",["unknown",["mutedNote"]]]]],["flush-element"],["append",["unknown",["currentNote","name"]],false],["close-element"],["text","\\n        "],["close-element"],["text","\\n        "],["open-element","div",[]],["static-attr","class","col s6"],["flush-element"],["text","\\n            "],["open-element","canvas",[]],["static-attr","id","centBar"],["static-attr","height","225px"],["static-attr","width","30px"],["static-attr","class","cent-bar"],["flush-element"],["close-element"],["text","\\n        "],["close-element"],["text","\\n    "],["close-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","row cents-label"],["flush-element"],["text","\\n        "],["open-element","div",[]],["static-attr","class","col s6 right"],["flush-element"],["text","\\n            Cents: "],["append",["unknown",["formattedCents"]],false],["text","\\n        "],["close-element"],["text","\\n    "],["close-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","row button-spacer"],["flush-element"],["close-element"],["text","\\n    "],["comment"," Detailed analysis "],["text","\\n"],["block",["if"],[["get",["showDetailedAnalysis"]]],null,1,0],["close-element"],["text","\\n"]],"locals":[],"named":[],"yields":[],"blocks":[{"statements":[["text","    "],["open-element","div",[]],["static-attr","class","row col s12 center"],["flush-element"],["text","\\n        "],["open-element","button",[]],["static-attr","class","btn-large waves-effect waves-light orange"],["dynamic-attr","onclick",["helper",["action"],[["get",[null]],"enableDetailedAnalysis",true],null],null],["flush-element"],["text","Show detailed signal analysis"],["close-element"],["text","\\n    "],["close-element"],["text","\\n"]],"locals":[]},{"statements":[["text","    "],["open-element","div",[]],["static-attr","class","row col s12 center"],["flush-element"],["text","\\n        "],["open-element","button",[]],["static-attr","class","btn-large waves-effect waves-light orange"],["dynamic-attr","onclick",["helper",["action"],[["get",[null]],"enableDetailedAnalysis",false],null],null],["flush-element"],["text","Hide detailed signal analysis"],["close-element"],["text","\\n    "],["close-element"],["text","\\n    "],["open-element","div",[]],["static-attr","id","frequencyPlot-container"],["flush-element"],["text","\\n    "],["close-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","row col s12 center"],["flush-element"],["text","\\n    "],["open-element","h4",[]],["flush-element"],["text","Analysis Statistics"],["close-element"],["text","\\n    "],["close-element"],["text","\\n    "],["open-element","div",[]],["static-attr","class","row col s12 center"],["flush-element"],["text","\\n        "],["open-element","table",[]],["static-attr","class","table-wrapper"],["flush-element"],["text","\\n            "],["open-element","tbody",[]],["flush-element"],["text","\\n                "],["open-element","tr",[]],["flush-element"],["open-element","th",[]],["static-attr","colspan","2"],["static-attr","class","no-right-border"],["flush-element"],["text","Real-Time Output Values"],["close-element"],["close-element"],["text","\\n                "],["open-element","tr",[]],["flush-element"],["open-element","td",[]],["flush-element"],["text","Average Peak Frequency (Hz)"],["close-element"],["open-element","td",[]],["flush-element"],["append",["unknown",["frequencyAverage"]],false],["close-element"],["close-element"],["text","\\n                "],["open-element","tr",[]],["flush-element"],["open-element","td",[]],["flush-element"],["text","Average Peak Power (dB)"],["close-element"],["open-element","td",[]],["flush-element"],["append",["unknown",["powerAverage"]],false],["close-element"],["close-element"],["text","\\n                "],["open-element","tr",[]],["flush-element"],["open-element","th",[]],["static-attr","colspan","2"],["static-attr","class","no-right-border"],["flush-element"],["text","Input Parameters"],["close-element"],["close-element"],["text","\\n                "],["open-element","tr",[]],["flush-element"],["open-element","td",[]],["flush-element"],["text","FFT Size (number of samples)"],["close-element"],["open-element","td",[]],["flush-element"],["append",["unknown",["fftSize"]],false],["close-element"],["close-element"],["text","\\n                "],["open-element","tr",[]],["flush-element"],["open-element","td",[]],["flush-element"],["text","Audio Sample Rate (Hz)"],["close-element"],["open-element","td",[]],["flush-element"],["append",["unknown",["sampleRate"]],false],["close-element"],["close-element"],["text","\\n                "],["open-element","tr",[]],["flush-element"],["open-element","td",[]],["flush-element"],["text","Cut-Off Threshold (dB)"],["close-element"],["open-element","td",[]],["flush-element"],["append",["unknown",["lowerDBThreshold"]],false],["close-element"],["close-element"],["text","\\n            "],["close-element"],["text","\\n        "],["close-element"],["text","\\n    "],["close-element"],["text","\\n"]],"locals":[]}],"hasPartials":false}',meta:{moduleName:"web-tuner/templates/tuner.hbs"}})}),define("web-tuner/config/environment",["ember"],function(e){try{var t="web-tuner/config/environment",n=document.querySelector('meta[name="'+t+'"]').getAttribute("content"),l=JSON.parse(unescape(n)),a={default:l};return Object.defineProperty(a,"__esModule",{value:!0}),a}catch(e){throw new Error('Could not read config from meta tag with name "'+t+'".')}}),runningTests||require("web-tuner/app").default.create({name:"web-tuner",version:"0.0.0+168a371f"});